
@{
    ViewData["Title"] = "聊天機器人設定";
    Layout = "~/Views/Shared/_AdminLayout.cshtml";
    var embedUrl = ViewBag.ChatbotEmbedUrl;
}
<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>@ViewData["Title"]</title>
</head>
<body>
    <h2>@ViewData["Title"]</h2>

    <div class="iframe-settings">
        <!-- URL 輸入框 -->
        <label for="url">聊天機器人 URL：</label>
        <br />
        <div class="input-group" style="width: 100%;">
            <input id="url" type="text" class="form-control" placeholder="輸入聊天機器人 URL" style="width: 90%;" />
            <button onclick="copyToClipboard('url')" class="btn btn-primary btn-sm">複製 URL</button>
        </div>
        <br />

        <!-- API 金鑰輸入框 -->
        <label for="apiKey">API 金鑰：</label>
        <br />
        <div class="input-group" style="width: 100%;">
            <input id="apiKey" type="text" class="form-control" placeholder="輸入 API 金鑰" style="width: 90%;" />
            <button onclick="copyToClipboard('apiKey')" class="btn btn-primary btn-sm">複製 API 金鑰</button>
        </div>
        <br />

        <!-- iFrame 代碼輸入框 -->
        <label for="iframeCode">嵌入聊天機器人的 iFrame 代碼：</label>
        <br />
        <div class="input-group" style="width: 100%;">
            <input id="iframeCode" type="text" readonly class="form-control" value='<iframe src="@embedUrl" style="position: fixed; bottom: 20px; right: 20px; width: 100%; height: 100%; border: none; padding: 0; margin: 0;" frameborder="0"></iframe>' />
            <button onclick="copyToClipboard('iframeCode')" class="btn btn-primary btn-sm">複製 iFrame 代碼</button>
        </div>
        <br />

        <!-- 儲存 URL 和 API 金鑰 -->
        <button onclick="saveSettings()" class="btn btn-success">儲存設定</button>
    </div>
    <script>
        // 複製到剪貼簿
        function copyToClipboard(elementId) {
            var element = document.getElementById(elementId);
            element.select();
            document.execCommand('copy');
            alert(elementId + ' 已複製到剪貼簿！');
        }
        // 儲存 URL 和 API 金鑰到 LocalStorage
        function saveSettings() {
            var url = document.getElementById('url').value;
            var apiKey = document.getElementById('apiKey').value;

            if (url && apiKey) {
                localStorage.setItem('chatbotUrl', url);
                localStorage.setItem('chatbotApiKey', apiKey);
                alert('設定已儲存！');
            } else {
                alert('請輸入完整的 URL 和 API 金鑰再儲存。');
            }
        }

        // 從 LocalStorage 載入 URL 和 API 金鑰
        function loadSettings() {
            var savedUrl = localStorage.getItem('chatbotUrl');
            var savedApiKey = localStorage.getItem('chatbotApiKey');

            if (savedUrl) {
                document.getElementById('url').value = savedUrl;
            }
            if (savedApiKey) {
                document.getElementById('apiKey').value = savedApiKey;
            }
        }

        // 在頁面載入時執行載入設定
        window.onload = function () {
            loadSettings();
        };
    </script>
</body>
</html>



